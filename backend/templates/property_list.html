<!DOCTYPE html>
<html>
<head>
    <title>Properties</title>
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        rel="stylesheet"
    >
</head>
<body class="container mt-4">

<h2>Available Properties</h2>

<table class="table table-bordered">
    <thead>
        <tr>
            <th>Title</th>
            <th>Price</th>
            <th>BHK</th>
            <th>Type</th>
            <th>City</th>
            <th>Locality</th>
            <th class="text-center">Compare</th>
            <th>Action</th>
        </tr>
    </thead>

    <tbody>
        {% for p in properties %}
        <tr>
            <td>{{ p.title }}</td>
            <td>{{ p.price }}</td>
            <td>{{ p.bhk }}</td>
            <td>{{ p.property_type }}</td>
            <td>{{ p.city }}</td>
            <td>{{ p.locality }}</td>

            <!-- Compare column -->
            <td class="text-center">
                <input
                    type="checkbox"
                    class="form-check-input compare-checkbox"
                    value="{{ p.id }}"
                >
            </td>

            <!-- Action column -->
            <td>
                <a
                    href="/properties/{{ p.id }}"
                    class="btn btn-sm btn-primary"
                >
                    View
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<button
    class="btn btn-outline-primary mt-3"
    onclick="compareSelected()"
>
    Compare Selected
</button>

<script>
function compareSelected() {
    const checked = document.querySelectorAll('.compare-checkbox:checked');
    const ids = Array.from(checked).map(cb => cb.value);

    if (ids.length < 2) {
        alert("Select at least two properties to compare.");
        return;
    }

    window.location.href = "/properties/compare/view?ids=" + ids.join(",");

}
</script>

</body>
</html>
